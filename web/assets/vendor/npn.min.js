var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,d){b instanceof String&&(b=String(b));for(var c=b.length,a=0;a<c;a++){var e=b[a];if(f.call(d,e,a,b))return{i:a,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,d){if(b==Array.prototype||b==Object.prototype)return b;b[f]=d.value;return b};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var f=0;f<b.length;++f){var d=b[f];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,f){var d=$jscomp.propertyToPolyfillSymbol[f];if(null==d)return b[f];d=b[d];return void 0!==d?d:b[f]};
$jscomp.polyfill=function(b,f,d,c){f&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,f,d,c):$jscomp.polyfillUnisolated(b,f,d,c))};$jscomp.polyfillUnisolated=function(b,f,d,c){d=$jscomp.global;b=b.split(".");for(c=0;c<b.length-1;c++){var a=b[c];if(!(a in d))return;d=d[a]}b=b[b.length-1];c=d[b];f=f(c);f!=c&&null!=f&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:f})};
$jscomp.polyfillIsolated=function(b,f,d,c){var a=b.split(".");b=1===a.length;c=a[0];c=!b&&c in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var e=0;e<a.length-1;e++){var g=a[e];if(!(g in c))return;c=c[g]}a=a[a.length-1];d=$jscomp.IS_SYMBOL_NATIVE&&"es6"===d?c[a]:null;f=f(d);null!=f&&(b?$jscomp.defineProperty($jscomp.polyfills,a,{configurable:!0,writable:!0,value:f}):f!==d&&($jscomp.propertyToPolyfillSymbol[a]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(a):$jscomp.POLYFILL_PREFIX+a,a=
$jscomp.propertyToPolyfillSymbol[a],$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:f})))};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(f,d){return $jscomp.findInternal(this,f,d).v}},"es6","es3");
$jscomp.checkStringArgs=function(b,f,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""};
$jscomp.polyfill("String.prototype.endsWith",function(b){return b?b:function(f,d){var c=$jscomp.checkStringArgs(this,f,"endsWith");f+="";void 0===d&&(d=c.length);d=Math.max(0,Math.min(d|0,c.length));for(var a=f.length;0<a&&0<d;)if(c[--d]!=f[--a])return!1;return 0>=a}},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(b){return b?b:function(f,d){var c=$jscomp.checkStringArgs(this,f,"startsWith");f+="";var a=c.length,e=f.length;d=Math.max(0,Math.min(d|0,c.length));for(var g=0;g<e&&d<a;)if(c[d++]!=f[g++])return!1;return g>=e}},"es6","es3");$jscomp.arrayIteratorImpl=function(b){var f=0;return function(){return f<b.length?{done:!1,value:b[f++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(b){if(b)return b;var f=function(a,e){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:e})};f.prototype.toString=function(){return this.$jscomp$symbol$id_};var d=0,c=function(a){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new f("jscomp_symbol_"+(a||"")+"_"+d++,a)};return c},"es6","es3");$jscomp.initSymbolIterator=function(){};
$jscomp.polyfill("Symbol.iterator",function(b){if(b)return b;b=Symbol("Symbol.iterator");for(var f="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),d=0;d<f.length;d++){var c=$jscomp.global[f[d]];"function"===typeof c&&"function"!=typeof c.prototype[b]&&$jscomp.defineProperty(c.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return b},"es6",
"es3");$jscomp.initSymbolAsyncIterator=function(){};$jscomp.iteratorPrototype=function(b){b={next:b};b[Symbol.iterator]=function(){return this};return b};$jscomp.iteratorFromArray=function(b,f){b instanceof String&&(b+="");var d=0,c={next:function(){if(d<b.length){var a=d++;return{value:f(a,b[a]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(f){return f})}},"es6","es3");var command;(function(b){b.client={ping:"ping",connect:"connect",getCollection:"getCollection",addURL:"addURL",getRequest:"getRequest",call:"call"};b.server={error:"error",pong:"pong",connected:"connected",collections:"collections",collectionDetail:"collectionDetail",requestDetail:"requestDetail",callResult:"callResult"}})(command||(command={}));var npn;
(function(b){b.onError=function(f,d){console.error(f+": "+d);var c=d.lastIndexOf(":");-1<c&&(d=d.substr(c+1));notify.notify(f+" error: "+d,!1)};b.init=function(f,d){try{var c=window.self!==window.top}catch(a){c=!0}c?(document.body.innerHTML="",document.body.appendChild(rbody.iframeError())):(log.init(),window.onbeforeunload=function(){socket.setAppUnloading()},nav.init(routing.route),socket.socketConnect(f,d,"wasm"===f))};b.debug=function(){var f=function(d,c){void 0===c&&(c="");console.warn(d+": "+
c)};f("Active Collection",collection.cache.active);f("Active Request",request.cache.active);f("Active Action",request.cache.action+" ["+request.cache.extra+"]")};b.testbed=function(){log.info("Testbed!")}})(npn||(npn={}));var routing;
(function(b){b.route=function(f){var d=f.split("/");d=d.filter(function(g){return 0<g.length});console.debug("nav: "+d.join(" -> "));f=0<d.length?d[0]:"c";switch(f){case "c":f=1<d.length&&0<d[1].length?d[1]:void 0;var c=2<d.length&&0<d[2].length?d[2]:void 0,a=3<d.length&&0<d[3].length?d[3]:void 0;d=4<d.length?d.slice(4):[];var e=collection.cache.active;collection.cache.setActiveCollection(f);f!==e&&f&&socket.send({svc:services.collection.key,cmd:command.client.getCollection,param:f});request.cache.setActiveRequest(c);
request.cache.setActiveAction(a,d);ui.setPanels(f,c,a,d);break;default:console.warn("unhandled svc ["+f+"]")}}})(routing||(routing={}));var services;
(function(b){b.system={key:"system",title:"System",plural:"systems",icon:"close"};b.collection={key:"collection",title:"Collection",plural:"Collections",icon:"folder"};b.request={key:"request",title:"Request",plural:"Requests",icon:"file-text"};var f=[b.system,b.collection];b.fromKey=function(d){var c=arr.find(f,function(a,e){return e.key===d});if(!c)throw"invalid service ["+d+"]";return c}})(services||(services={}));var rbody;
(function(b){b.renderBody=function(f,d){if(!d)return JSX("div",null,"No body");switch(d.type){case "json":return d=d.config,JSX("div",null,JSX("em",null,"JSON"),JSX("pre",null,json.str(d.msg)));case "html":return f=request.baseURL(f),d=d.config,JSX("div",{class:"html-body"},JSX("span",{class:"base-url hidden"},f),JSX("span",{class:"preview-link right"},"(",JSX("a",{class:style.linkColor,href:"",onclick:"rbody.renderHTMLPreview(this);return false"},"preview"),")"),JSX("span",{class:"text-link right hidden"},
"(",JSX("a",{class:style.linkColor,href:"",onclick:"rbody.renderHTMLText(this);return false"},"text"),")"),JSX("em",null,"HTML"),JSX("pre",{class:"text-content",style:"overflow: auto; max-height: 720px;"},d.content),JSX("div",{class:"preview-content uk-margin-top hidden",style:"overflow: auto; max-height: 720px; border: 1px solid #666;"}));case "image":return d=d.config,JSX("img",{alt:"response image",src:"data:"+d.type+";base64,"+d.content});case "raw":return d=d.config,JSX("div",null,JSX("em",null,
d.type?d.type:"Unknown Type"),JSX("pre",null,json.str(d)));case "error":return d=d.config,JSX("div",null,JSX("em",null,"Error"),JSX("pre",null,d.message));default:return JSX("div",null,"unhandled body type [",d.type,"]")}}})(rbody||(rbody={}));
(function(b){function f(d,c){var a=d.parentElement.parentElement;if(!a.classList.contains("html-body"))throw"container is not class [html-body]";d=dom.req(".base-url",a);var e=dom.req(".text-link",a),g=dom.req(".text-content",a),h=dom.req(".preview-link",a);a=dom.req(".preview-content",a);dom.setDisplay(e,c);dom.setDisplay(g,!c);dom.setDisplay(h,!c);dom.setDisplay(a,c);return[d.innerText,g,a]}b.renderHTMLPreview=function(d){d=f(d,!0);var c=document.createElement("iframe");c.style.width="100%";c.style.minHeight=
"720px";var a=d[0];var e=d[1].innerText;var g=e.indexOf("<head");-1<g&&(g=e.indexOf(">",g),-1<g&&(a='<base href="'+a+'" target="_blank">',e=e.substr(0,g+1)+a+e.substr(g+1)));d[2].innerHTML="";d[2].appendChild(c);d=c.contentDocument||c.contentWindow.document;d.open();d.write(e);d.close()};b.renderHTMLText=function(d){f(d,!1)};b.iframeError=function(){return JSX("div",{class:"uk-container"},JSX("div",{class:"uk-section uk-section-small"},JSX("h3",null,"Rendering Error"),JSX("p",null,"This page indicates that the HTML preview was unable to render.")))}})(rbody||
(rbody={}));(function(b){b.AllTypes=[{key:"error",title:"Error",hidden:!0},{key:"form",title:"Form",hidden:!1},{key:"html",title:"HTML",hidden:!1},{key:"json",title:"JSON",hidden:!1},{key:"large",title:"Large File",hidden:!1},{key:"raw",title:"Raw",hidden:!0}]})(rbody||(rbody={}));var call;
(function(b){b.prepare=function(f,d){socket.send({svc:services.request.key,cmd:command.client.call,param:{coll:f,req:d.key,proto:d.prototype}})};b.setResult=function(f){var d=dom.req("#"+f.collection+"--"+f.request+"-call");dom.setContent(d,b.renderResult(f))}})(call||(call={}));
(function(b){function f(a,e){void 0===e&&(e=[]);return 0===e.length?c(a,"No headers"):JSX("div",{class:"uk-overflow-auto"},JSX("h4",null,a),JSX("table",{class:"uk-table uk-table-divider uk-text-left uk-table-small uk-table-justify"},JSX("tbody",null,e.map(function(g){return JSX("tr",{title:g.desc},JSX("td",{class:"uk-text-nowrap"},g.k),JSX("td",{class:"uk-text-nowrap"},g.v))}))))}function d(a){if(!a)return JSX("div",null,"No timing");a=b.timingSections(a);return JSX("div",{class:"timing-panel"},JSX("div",
{class:"result-timing-graph"},JSX("object",{type:"image/svg+xml",style:"width: 100%; height: "+24*a.length+"px",data:b.timingGraph(a)},"SVG not supported")),JSX("hr",null),a.map(function(e){return JSX("div",null,e.key,": ",e.start," - ",e.end)}))}function c(a,e){e||(e="undefined");return JSX("div",null,JSX("h4",null,a)," ",e)}b.renderResult=function(a){var e,g,h,k=JSX("div",null,"no result"),l=a.response;if(l){k=l.contentType||"";var m=l.contentLength&&-1<l.contentLength?"("+l.contentLength+" bytes)":
l.body&&-1<l.body.length?"("+l.body.length+" bytes)":"";k=JSX("div",null,l.proto," ",JSX("em",null,l.status),JSX("div",null,k," ",m))}return[JSX("div",{class:"right"},JSX("a",{class:"theme uk-icon","data-uk-icon":"close",href:"",onclick:"nav.pop();return false;",title:"close result"})),JSX("div",{class:"clear"}),JSX("div",null,JSX("ul",{"data-uk-tab":""},JSX("li",null,JSX("a",{href:"#result"},"Result")),JSX("li",null,JSX("a",{href:"#request"},"Request")),JSX("li",null,JSX("a",{href:"#headers"},"Response")),
JSX("li",null,JSX("a",{href:"#body"},"Body")),JSX("li",null,JSX("a",{href:"#timing"},"Timing"))),JSX("ul",{class:"uk-switcher uk-margin"},JSX("li",null,JSX("div",null,a.status,": ",((null===(e=a.timing)||void 0===e?void 0:e.completed)||0)/1E3,"ms"),k),JSX("li",null,JSX("h3",{class:"uk-margin-small-bottom"},a.url),f("Final Request Headers",a.requestHeaders)),JSX("li",null,f("Response Headers",null===(g=a.response)||void 0===g?void 0:g.headers)),JSX("li",null,rbody.renderBody(a.url,null===(h=a.response)||
void 0===h?void 0:h.body)),JSX("li",null,d(a.timing))))]}})(call||(call={}));
(function(b){b.timingSections=function(f){var d=[],c=function(e,g,h,k){h&&k&&d.push({key:e,group:g,start:h,end:k})};c("dns","connect",f.dnsStart,f.dnsEnd);c("connect","connect",f.connectStart,f.connectEnd);var a=f.connectEnd;0<(f.tlsEnd||0)&&(a=f.tlsEnd||0,c("tls","connect",f.tlsStart||0,a));c("reqheaders","request",a,f.wroteHeaders);2<f.wroteRequest-f.wroteHeaders&&c("reqbody","request",f.wroteHeaders,f.wroteRequest);c("rspwait","response",f.wroteRequest,f.firstResponseByte);c("rspheaders","response",
f.firstResponseByte,f.responseHeaders);c("rspbody","response",f.responseHeaders,f.completed);return d};b.timingGraph=function(f){for(var d,c=[],a=0;a<f.length;a++){var e=f[a];0<e.group.length&&c.push(encodeURIComponent(e.key+".g")+"="+encodeURIComponent(e.group));c.push(encodeURIComponent(e.key+".s")+"="+encodeURIComponent(e.start));c.push(encodeURIComponent(e.key+".e")+"="+encodeURIComponent(e.end))}c.push("t="+(null===(d=system.cache.profile)||void 0===d?void 0:d.theme)||"light");return"/svg/gantt?"+
c.join("&")}})(call||(call={}));var collection;(function(b){var f=function(){function d(){this.collections=[]}d.prototype.updateCollection=function(c){this.collections=group.updateAndSort(this.collections,c,function(a){return a.key});b.renderCollections(this.collections)};d.prototype.setActiveCollection=function(c){this.active!==c&&(this.active=c,b.renderCollections(this.collections))};return d}();b.cache=new f})(collection||(collection={}));
(function(b){function f(c){var a=c.title;a&&0!==a.length||(a=c.key);var e=nav.link({path:"/c/"+c.key,title:a,icon:"folder"});if(b.cache.active===c.key){var g=request.cache.active,h=request.cache.summaries.get(c.key);h&&(e=void 0,e=g?nav.link({path:"/c/"+c.key,title:a,icon:"album"}):JSX("strong",null,nav.link({path:"/",title:a,icon:"album"})),e=JSX("div",null,e,h.map(function(k){var l=nav.link({path:"/c/"+c.key+"/"+k.key,title:k.title&&0<k.title.length?k.title:k.key,icon:"link"});return JSX("div",
{class:"uk-margin-small-left"},request.cache.active===k.key?JSX("strong",null,l):l)})))}return JSX("div",{class:"nav-item collection-link collection-link-"+c.key},e)}function d(c,a){a=group.sort(a,function(e){return e.order});return JSX("ul",{class:"uk-list uk-list-divider"},a.map(function(e){var g=e.title;g&&0!==e.title.length||(g=e.key);return JSX("li",null,nav.link({path:"/c/"+c+"/"+e.key,title:g}),e.description&&e.description.length?JSX("div",null,JSX("em",null,e.description)):JSX("span",null))}))}
b.renderCollections=function(c){return dom.els(".collection-list").forEach(function(a){dom.setContent(a,c.map(function(e){return f(e)}))})};b.renderCollection=function(c,a){var e=c.title?c.title:c.key;return JSX("div",null,JSX("div",{class:"uk-card uk-card-body uk-card-default"},JSX("div",{class:"right"},JSX("a",{class:"theme uk-icon","data-uk-icon":"close",href:"",onclick:"nav.pop();return false;",title:"close collection"})),JSX("h3",{class:"uk-card-title"},JSX("span",{class:"nav-icon-h3","data-uk-icon":"icon: album"}),
e),JSX("p",null,c.description||"")),JSX("div",{class:"uk-card uk-card-body uk-card-default uk-margin-top"},JSX("h3",{class:"uk-card-title"},"Requests"),JSX("form",{onsubmit:"collection.addRequestURL();return false;"},JSX("div",{class:"uk-margin-top uk-inline uk-width-expand"},JSX("button",{class:"uk-form-icon uk-form-icon-flip",type:"submit",title:"add request","uk-icon":"icon: plus"}),JSX("input",{id:"coll-request-add-url",class:"uk-input",placeholder:"add a request by url","data-lpignore":"true"}))),
JSX("div",{id:"request-list",class:"uk-margin-top"},d(c.key,a))))};b.addRequestURL=function(){var c=dom.req("#coll-request-add-url"),a=c.value.trim();a&&0<a.length&&(c.value="",socket.send({svc:services.collection.key,cmd:command.client.addURL,param:{coll:b.cache.active,url:a}}),log.info("adding request ["+a+"]"))}})(collection||(collection={}));
(function(b){b.onCollectionMessage=function(f,d){switch(f){case command.server.collections:b.cache.collections=group.sort(d,function(c){return c.key});log.info("processing ["+b.cache.collections.length+"] collections");b.renderCollections(b.cache.collections);break;case command.server.collectionDetail:log.info("processing ["+d.requests.length+"] requests for collection ["+d.collection.key+"]");b.cache.updateCollection(d.collection);request.cache.setCollectionRequests(d.collection,d.requests);b.renderCollections(b.cache.collections);
break;default:console.warn("unhandled collection command ["+f+"]")}}})(collection||(collection={}));var header;
(function(b){function f(c,a,e,g){return{key:c,description:a,req:e,rsp:g,link:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/"+c}}b.commonHeaders=[f("Accept","Informs the server about the types of data that can be sent back.",!0,!1),f("Access-Control-Allow-Headers","Used in response to a preflight request to indicate which HTTP headers can be used when making the actual request.",!1,!0),f("Access-Control-Allow-Methods","Specifies the methods allowed when accessing the resource in response to a preflight request.",
!1,!0),f("Access-Control-Allow-Origin","Indicates whether the response can be shared.",!1,!0),f("Authorization","Contains the credentials to authenticate a user-agent with a server.",!0,!1),f("Connection","Controls whether the network connection stays open after the current transaction finishes.",!0,!1),f("Content-Encoding","Used to specify the compression algorithm.",!0,!0),f("Content-Length","The size of the resource, in decimal number of bytes.",!0,!0),f("Content-Type","Indicates the media type of the resource.",
!0,!0),f("Cookie","Contains stored HTTP cookies previously sent by the server with the Set-Cookie header.",!0,!1),f("Date","The Date general HTTP header contains the date and time at which the message was originated.",!1,!0),f("ETag","A unique string identifying the version of the resource.",!1,!0),f("Expires","The date/time after which the response is considered stale.",!1,!0),f("Host","Specifies the domain name of the server (for virtual hosting), and (optionally) the TCP port number on which the server is listening.",
!0,!1),f("Last-Modified","The last modification date of the resource, used to compare several versions of the same resource.",!1,!0),f("Location","Indicates the URL to redirect a page to. ",!1,!0),f("Origin","Indicates where a fetch originates from.",!0,!1),f("Referer","The address of the previous web page from which a link to the currently requested page was followed.",!0,!1),f("Server","Contains information about the software used by the origin server to handle the request.",!1,!0),f("Set-Cookie",
"Send cookies from the server to the user-agent.",!1,!0),f("User-Agent","Contains a characteristic string that allows the network protocol peers to identify the application",!0,!1)];var d;b.getCommonHeaderByName=function(c){if(!d){d=new map.Map;for(var a=0,e=b.commonHeaders;a<e.length;a++){var g=e[a];d.set(g.key,g)}}return d.get(c)};b.dumpCommonHeaders=function(){var c=function(a,e,g){var h=!1;console.debug("\n::: "+a+" Headers");b.commonHeaders.forEach(function(k){k.req==e&&k.rsp==g&&(h=!0,console.debug(k.key+
": "+k.link),console.debug("  - "+k.description))});h||console.debug("none")};c("Common",!0,!0);c("Request",!0,!1);c("Response",!1,!0);c("Invalid",!1,!1)}})(header||(header={}));var request;
(function(b){function f(){return JSX("div",{class:"right"},JSX("a",{class:"theme uk-icon","data-uk-icon":"close",href:"",onclick:"nav.navigate(`/c/${collection.cache.active}/${request.cache.active}`);return false;",title:"close collection"}))}b.renderActionEmpty=function(){return JSX("div",null)};b.renderActionUnknown=function(d,c){return JSX("div",null,f(),"unknown action: ",d," (",c,")")};b.renderActionCall=function(d,c){return JSX("div",{id:d+"--"+c+"-call"},f(),JSX("div",{class:"call-title"},
"Loading..."),JSX("div",{class:"call-result"}))};b.renderActionTransform=function(d,c,a){return JSX("div",{id:d+"--"+c+"-transform"},f(),JSX("div",{class:"transform-title"},a),JSX("div",{class:"transform-result"}))}})(request||(request={}));
(function(b){var f=function(){function d(){this.summaries=new map.Map;this.requests=new map.Map;this.extra=[]}d.prototype.setCollectionRequests=function(c,a){this.summaries.set(c.key,a);if(c.key===collection.cache.active)for(dom.setContent("#collection-panel",collection.renderCollection(c,a)),c=0;c<a.length;c++){var e=a[c];this.active===e.key&&(b.renderActiveRequest(collection.cache.active),this.action&&b.renderAction(collection.cache.active,e.key,this.action,this.extra))}};d.prototype.setActiveRequest=
function(c){collection.cache.active&&this.active!==c&&((this.active=c)&&b.renderActiveRequest(collection.cache.active),collection.renderCollections(collection.cache.collections))};d.prototype.setActiveAction=function(c,a){if(collection.cache.active){var e=this.extra.length===a.length&&this.extra.every(function(g,h){return g===a[h]});!this.active||this.action===c&&e||(this.action=c,this.extra=a,b.renderAction(collection.cache.active,this.active,this.action,this.extra))}};d.prototype.updateRequest=
function(c){if(collection.cache.active){var a=this.requests.get(collection.cache.active);c=group.update(a,c,function(e){return e.key});this.requests.set(collection.cache.active,c)}};return d}();b.cache=new f})(request||(request={}));
(function(b){b.diff=function(f,d){var c=[],a=function(k,l,m){l!==m&&c.push({k:k,l:l,r:m})},e=function(k,l,m){return f?d?!1:(c.push({k:k,l:"(defined)",r:null}),!0):(d&&c.push({k:k,l:null,r:"(defined)"}),!0)};if(e("request",f,d))return c;a("key",f.key,d.key);a("title",f.title,d.title);a("description",f.description,d.description);var g=f.prototype,h=d.prototype;a("method",g.method,h.method);a("protocol",g.protocol,h.protocol);a("domain",g.domain,h.domain);a("port",g.port,h.port);a("path",g.path,h.path);
if(!e("query",g.query,h.query)){if(!g.query||!h.query)return c;a("query.length",g.query.length,h.query.length)}a("fragment",g.fragment,h.fragment);if(!e("headers",g.headers,h.headers)){if(!g.headers||!h.headers)return c;a("headers.length",g.headers.length,h.headers.length)}if(!e("auth",g.auth,h.auth)){if(!g.auth||!h.auth)return c;a("auth.length",g.auth.length,h.auth.length)}if(!e("body",g.body,h.body)){if(!g.body||!h.body)return c;a("body.type",g.body.type,h.body.type);a("body.config",g.body.config,
h.body.config)}g=g.options;h=h.options;if(e("options",g,h)||!g||!h)return c;a("timeout",g.timeout,h.timeout);a("ignoreRedirects",g.ignoreRedirects,h.ignoreRedirects);a("ignoreReferrer",g.ignoreReferrer,h.ignoreReferrer);a("ignoreCerts",g.ignoreCerts,h.ignoreCerts);a("ignoreCookies",g.ignoreCookies,h.ignoreCookies);a("excludeDefaultHeaders",g.excludeDefaultHeaders,h.excludeDefaultHeaders);a("readCookieJars",g.readCookieJars,h.readCookieJars);a("writeCookieJar",g.writeCookieJar,h.writeCookieJar);a("sslCert",
g.sslCert,h.sslCert);a("userAgentOverride",g.userAgentOverride,h.userAgentOverride);return c}})(request||(request={}));
(function(b){function f(d,c){var a=0;for(d=b.cache.requests.get(d)||[];a<d.length;a++){var e=d[a];if(e.key===c)return e}}b.getActiveRequest=function(){return f(collection.cache.active,b.cache.active)};b.getSummary=function(d,c){var a=0;for(d=b.cache.summaries.get(d)||[];a<d.length;a++){var e=d[a];if(e.key===c)return e}};b.getRequest=f;b.onRequestMessage=function(d,c){switch(d){case command.server.requestDetail:b.cache.updateRequest(c);b.cache.active===c.key&&(b.renderActiveRequest(collection.cache.active),
b.renderAction(collection.cache.active,b.cache.active,b.cache.action,b.cache.extra));break;case command.server.callResult:debugger;call.setResult(c);break;default:console.warn("unhandled request command ["+d+"]")}}})(request||(request={}));
(function(b){b.MethodGet={key:"GET",description:""};b.MethodHead={key:"HEAD",description:""};b.MethodPost={key:"POST",description:""};b.MethodPut={key:"PUT",description:""};b.MethodPatch={key:"PATCH",description:""};b.MethodDelete={key:"DELETE",description:""};b.MethodConnect={key:"CONNECT",description:""};b.MethodOptions={key:"OPTIONS",description:""};b.MethodTrace={key:"TRACE",description:""};b.allMethods=[b.MethodGet,b.MethodHead,b.MethodPost,b.MethodPut,b.MethodPatch,b.MethodDelete,b.MethodConnect,
b.MethodOptions,b.MethodTrace]})(request||(request={}));
(function(b){function f(d,c,a,e,g,h,k){str.endsWith(d,":")&&(d=d.substr(0,d.length-1));str.startsWith(h,"#")&&(h=h.substr(1));return{method:"get",protocol:d,domain:c,port:a,path:e,query:g,fragment:h,auth:k}}b.prototypeFromURL=function(d){d=new URL(d);var c=[];d.searchParams.forEach(function(g,h){return c.push({k:g,v:h})});var a=[];0<d.username.length&&a.push({type:"basic",config:{username:d.username,password:d.password,showPassword:!0}});var e;d.port&&0<d.port.length&&(e=parseInt(d.port,10));return f(d.protocol,
d.hostname,e,d.pathname,c,d.hash,a)}})(request||(request={}));
(function(b){b.renderActiveRequest=function(f){if(b.cache.active){var d=b.getRequest(f,b.cache.active);if(d)dom.setContent("#request-panel",b.form.renderFormPanel(f,d)),b.editor.wireForm(d.key);else if(d=b.getSummary(f,b.cache.active))dom.setContent("#request-panel",b.renderSummaryPanel(f,d)),socket.send({svc:services.request.key,cmd:command.client.getRequest,param:{coll:f,req:d.key}})}else console.warn("no active request")};b.renderAction=function(f,d,c,a){var e=dom.opt(".request-editor"),g=dom.opt(".request-action");
if(e&&g){switch(c){case void 0:dom.setContent(g,b.renderActionEmpty());break;case "call":call.prepare(f,b.form.extractRequest());dom.setContent(g,b.renderActionCall(f,d));break;case "transform":dom.setContent(g,b.renderActionTransform(f,d,a[0]));break;default:console.warn("unhandled request action ["+c+"]"),dom.setContent(g,b.renderActionUnknown(c,a))}dom.setDisplay(e,void 0===c);dom.setDisplay(g,void 0!==c)}}})(request||(request={}));
(function(b){b.renderSummaryPanel=function(f,d){return JSX("div",null,JSX("div",{class:"uk-card uk-card-body uk-card-default"},JSX("div",{class:"right"},JSX("a",{class:"theme uk-icon","data-uk-icon":"close",href:"",onclick:"nav.navigate('/c/"+f+"');return false;",title:"close request"})),JSX("h3",{class:"uk-card-title"},d.title?d.title:d.key),JSX("p",null,"Loading...")))}})(request||(request={}));
(function(b){function f(e){e=new URL(e);return{method:b.MethodGet.key,protocol:str.trimSuffix(e.protocol,":"),domain:e.hostname,port:e.port?parseInt(e.port,10):void 0,path:str.trimPrefix(e.pathname,"/"),fragment:str.trimPrefix(e.hash,"#")}}function d(e){if(!e)return"invalid";var g=e.domain;e.port&&0<e.port&&(g+=":"+e.port);return e.protocol+"://"+g+"/"}function c(e){var g=[],h=function(n,p){g.push({t:n,v:p})};h("protocol",e.protocol);h("","://");if(e.auth)for(var k=0,l=e.auth;k<l.length;k++){var m=
l[k];if("basic"===m.type){k=m.config;h("username",k.username);h("",":");k.showPassword?h("password",k.password):h("password","****");h("","@");break}}h("domain",e.domain);e.port&&(h("",":"),h("port",e.port.toString()));e.path&&0<e.path.length&&(h("","/"),h("path",e.path));e.query&&0<e.query.length&&(h("","?"),k=e.query.map(function(n){return encodeURIComponent(n.k)+"="+encodeURIComponent(n.v)}).join("&"),h("query",k));e.fragment&&0<e.fragment.length&&(h("","#"),h("fragment",encodeURIComponent(e.fragment)));
return g}function a(e){switch(e){case "username":case "password":case "protocol":case "auth":return"green-fg";case "domain":case "port":return"blue-fg";case "path":return"bluegrey-fg";case "query":return"purple-fg";default:return""}}b.urlToPrototype=f;b.prototypeToURL=function(e){return c(e).map(function(g){return g.v}).join("")};b.prototypeToHTML=function(e){return JSX("span",null,c(e).map(function(g){return JSX("span",{title:g.t,class:a(g.t)},g.v)}))};b.baseURL=function(e){return d(f(e))};b.prototypeBaseURL=
d})(request||(request={}));
(function(b){(function(f){f.initAuthEditor=function(d){};f.setAuth=function(d,c){var a=new URL(d.url.value),e="",g="";if(c)for(var h=0;h<c.length;h++){var k=c[h];"basic"===k.type&&(g=k.config,e=encodeURIComponent(g.username),g=encodeURIComponent(g.password))}a.username=e;a.password=g;d.url.value=a.toString()};f.updateBasicAuth=function(d,c){var a=[];try{a=json.parse(d.auth.value)}catch(l){console.warn("invalid auth JSON ["+d.auth.value+"]")}var e=-1;a||(a=[]);for(var g=0;g<a.length;g++){var h=a[g];
"basic"===h.type&&(e=g)}if(c)for(g=0;g<c.length;g++)if(h=c[g],"basic"===h.type)var k=h.config;-1===e?k&&a.push({type:"basic",config:k}):k?(c=(c=a[e].config)?{username:k.username,password:k.password,showPassword:c.showPassword}:k,a[e]={type:"basic",config:c}):a.splice(e,1);d.auth.value=json.str(a)}})(b.editor||(b.editor={}))})(request||(request={}));
(function(b){(function(f){function d(c){var a=json.parse(c.value);return JSX("div",{class:"uk-margin-top"},JSX("select",{class:"uk-select"},JSX("option",{value:""},"No body"),rbody.AllTypes.filter(function(e){return!e.hidden}).map(function(e){return a&&a.type===e.key?JSX("option",{value:e.key,selected:"selected"},e.title):JSX("option",{value:e.key},e.title)}),"\u02d9"),rbody.AllTypes.filter(function(e){return!e.hidden}).map(function(e){var g=a&&a.type==e.key?a.config:null;a:{var h=e.key,k="uk-margin-top body-editor-"+
h;e.key!==(a?a.type:"")&&(k+=" hidden");switch(h){case "json":e=JSX("div",{class:k},JSX("textarea",{class:"uk-textarea"},json.str(g?g.msg:null)));break a;default:e=JSX("div",{class:k},"Unimplemented [",h,"] editor")}}return e}))}f.initBodyEditor=function(c){c.parentElement.appendChild(d(c))};f.setBody=function(c,a){}})(b.editor||(b.editor={}))})(request||(request={}));
(function(b){(function(f){function d(a,e){a.onchange=e;a.onkeyup=e;a.onblur=e}function c(a){d(a.url,function(){f.setURL(a,b.prototypeFromURL(a.url.value))});d(a.auth,function(){try{var e=json.parse(a.auth.value)}catch(g){console.warn("invalid auth JSON ["+a.auth.value+"]"),e=[]}f.setAuth(a,e)});d(a.qp,function(){try{var e=json.parse(a.qp.value)}catch(g){console.warn("invalid qp JSON ["+a.qp.value+"]"),e=[]}f.setQueryParams(a,e)});d(a.headers,function(){try{var e=json.parse(a.headers.value)}catch(g){console.warn("invalid headers JSON ["+
a.headers.value+"]"),e=[]}f.setHeaders(a,e)});d(a.body,function(){try{var e=json.parse(a.body.value)}catch(g){console.warn("invalid body JSON ["+a.body.value+"]")}f.setBody(a,e)})}f.wireForm=function(a){a={url:dom.req("#"+a+"-url"),auth:dom.req("#"+a+"-auth"),qp:dom.req("#"+a+"-queryparams"),headers:dom.req("#"+a+"-headers"),body:dom.req("#"+a+"-body"),options:dom.req("#"+a+"-options")};f.initURLEditor(a.url);f.initAuthEditor(a.auth);f.initQueryParamsEditor(a.qp);f.initHeadersEditor(a.headers);f.initBodyEditor(a.body);
f.initOptionsEditor(a.options);c(a)}})(b.editor||(b.editor={}))})(request||(request={}));
(function(b){(function(f){function d(a){var e=JSX("ul",{id:a.id+"-ul",class:"uk-list uk-list-divider"}),g=JSX("li",null,JSX("div",{"data-uk-grid":""},JSX("div",{class:"uk-width-1-4"},"Name"),JSX("div",{class:"uk-width-1-4"},"Value"),JSX("div",{class:"uk-width-1-2"},JSX("div",{class:"right"},JSX("a",{class:style.linkColor,href:"",onclick:"request.editor.addChild(dom.req('#"+a.id+"-ul'), {k: '', v: ''});return false;",title:"new header"},JSX("span",{"data-uk-icon":"icon: plus"}))),"Description")));
a=json.parse(a.value);e.innerText="";e.appendChild(g);if(a)for(g=0;g<a.length;g++)c(e,a[g]);return e}function c(a,e){a.appendChild(JSX("li",null,JSX("div",{"data-uk-grid":""},JSX("div",{class:"uk-width-1-4"},e.k),JSX("div",{class:"uk-width-1-4"},e.v),JSX("div",{class:"uk-width-1-2"},JSX("div",{class:"right"},JSX("a",{class:style.linkColor,href:"",onclick:"return false;",title:"new header"},JSX("span",{"data-uk-icon":"icon: close"}))),e.desc?e.desc:""))))}f.initHeadersEditor=function(a){a.parentElement.appendChild(d(a))};
f.setHeaders=function(a,e){};f.addChild=c})(b.editor||(b.editor={}))})(request||(request={}));
(function(b){(function(f){function d(a){var e=json.parse(a.value);e||(e={});return JSX("div",null,JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.id+"-timeout"},"Timeout"),JSX("input",{class:"uk-input",id:a.id+"-timeout",name:"opt-timeout",type:"number",value:e.timeout})),JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label"},"Ignore"),JSX("div",null,c(a.id,"ignoreRedirects","Redirects",e.ignoreRedirects||!1),c(a.id,"ignoreReferrer","Referrer",e.ignoreReferrer||
!1),c(a.id,"ignoreCerts","Certs",e.ignoreCerts||!1),c(a.id,"ignoreCookies","Cookies",e.ignoreCookies||!1))),JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.id+"-excludeDefaultHeaders"},"Exclude Default Headers"),JSX("input",{class:"uk-input",id:a.id+"-excludeDefaultHeaders",name:"opt-excludeDefaultHeaders",type:"text",value:e.excludeDefaultHeaders})),JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.id+"-readCookieJars"},"Read Cookie Jars"),JSX("input",
{class:"uk-input",id:a.id+"-readCookieJars",name:"opt-readCookieJars",type:"text",value:e.readCookieJars})),JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.id+"writeCookieJar"},"Write Cookie Jar"),JSX("input",{class:"uk-input",id:a.id+"-writeCookieJar",name:"opt-writeCookieJar",type:"text",value:e.writeCookieJar})),JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.id+"-sslCert"},"SSL Cert"),JSX("input",{class:"uk-input",id:a.id+"-sslCert",name:"opt-sslCert",
type:"text",value:e.sslCert})),JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.id+"-userAgentOverride"},"User Agent Override"),JSX("input",{class:"uk-input",id:a.id+"-userAgentOverride",name:"opt-userAgentOverride",type:"text",value:e.userAgentOverride})))}function c(a,e,g,h){a="opt-"+e;return h?JSX("label",{class:"uk-margin-right"},JSX("input",{type:"checkbox",name:a,value:"true",checked:!0})," ",g):JSX("label",{class:"uk-margin-right"},JSX("input",{type:"checkbox",name:a,
value:"true"})," ",g)}f.initOptionsEditor=function(a){a.parentElement.appendChild(d(a))}})(b.editor||(b.editor={}))})(request||(request={}));
(function(b){(function(f){f.initQueryParamsEditor=function(d){};f.setQueryParams=function(d,c){var a=[];if(c)for(var e=0;e<c.length;e++){var g=c[e];a.push(encodeURIComponent(g.k)+"="+encodeURIComponent(g.v))}c=new URL(d.url.value);c.search=a.join("&");d.url.value=c.toString()};f.updateQueryParams=function(d,c){d.qp.value=json.str(c)}})(b.editor||(b.editor={}))})(request||(request={}));
(function(b){(function(f){f.initURLEditor=function(d){};f.setURL=function(d,c){c?(f.updateQueryParams(d,c.query),f.updateBasicAuth(d,c.auth)):d.qp.value="[]"}})(b.editor||(b.editor={}))})(request||(request={}));
(function(b){(function(f){function d(c){return dom.req("#"+b.cache.active+"-"+c).value}f.extractRequest=function(){var c=d("key"),a=d("title"),e=d("description"),g=d("url");g=b.urlToPrototype(g);g.method=d("method");g.query=json.parse(d("queryparams"));g.headers=json.parse(d("headers"));g.auth=json.parse(d("auth"));g.body=json.parse(d("body"));g.options=json.parse(d("options"));return{key:c,title:a,description:e,prototype:g}}})(b.form||(b.form={}))})(request||(request={}));
(function(b){(function(f){function d(a,e){var g="/c/"+a+"/"+e.key;a="if (!confirm('Are you sure you want to delete request ["+e.key+"]?')) { return false; }";return JSX("div",null,nav.link({path:g+"/call",title:"Call",cls:"uk-button uk-button-default uk-margin-small-right uk-margin-top",isButton:!0}),JSX("div",{class:"uk-inline"},JSX("button",{type:"button",class:"uk-button uk-button-default uk-margin-small-right uk-margin-top"},"Export"),JSX("div",{id:"export-dropdown","uk-dropdown":"mode: click"},
JSX("ul",{class:"uk-list uk-list-divider",style:"margin-bottom: 0;"},Object.keys(c).map(function(h){return JSX("li",null,nav.link({path:g+"/transform/"+h,title:c[h],onclk:"UIkit.dropdown(dom.req('#export-dropdown')).hide(false);"}))})))),nav.link({path:g+"/delete",title:"Delete",cls:"uk-button uk-button-default uk-margin-small-right uk-margin-top",onclk:a,isButton:!0}))}f.renderFormPanel=function(a,e){return JSX("div",null,JSX("div",{class:"uk-card uk-card-body uk-card-default"},JSX("div",{class:"right"},
JSX("a",{class:"theme uk-icon","data-uk-icon":"close",href:"",onclick:"nav.navigate('/c/"+a+"');return false;",title:"close request"})),JSX("h3",{class:"uk-card-title"},e.title?e.title:e.key),f.renderURL(e),JSX("div",{id:"save-panel",class:"right hiddenX"},JSX("button",{class:"uk-button uk-button-default uk-margin-small-right uk-margin-top",onclick:"console.warn('TODO!');"},"Reset"),JSX("button",{class:"uk-button uk-button-default uk-margin-top",onclick:"request.form.extractRequest();"},"Save Changes")),
d(a,e)),JSX("div",{class:"request-editor uk-card uk-card-body uk-card-default uk-margin-top"},f.renderSwitcher(e)),JSX("div",{class:"request-action uk-card uk-card-body uk-card-default uk-margin-top hidden"}))};f.renderDetails=function(a){return JSX("li",{class:"request-details-panel"},JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.key+"-key"},"Key"),JSX("input",{class:"uk-input",id:a.key+"-key",name:"key",type:"text",value:a.key||"","data-lpignore":"true"})),JSX("div",
{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.key+"-title"},"Title"),JSX("input",{class:"uk-input",id:a.key+"-title",name:"title",type:"text",value:a.title||"","data-lpignore":"true"})),JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:a.key+"-description"},"Description"),JSX("textarea",{class:"uk-textarea",id:a.key+"-description",name:"description","data-lpignore":"true"},a.description||"")))};var c={http:"HTTP",json:"JSON",curl:"curl"}})(b.form||(b.form=
{}))})(request||(request={}));
(function(b){(function(f){f.renderSwitcher=function(d){var c=d.key,a=d.prototype,e=JSX("ul",{"data-uk-tab":""},JSX("li",null,JSX("a",{href:"#details"},"Details")),JSX("li",null,JSX("a",{href:"#query"},"Query")),JSX("li",null,JSX("a",{href:"#auth"},"Auth")),JSX("li",null,JSX("a",{href:"#headers"},"Headers")),JSX("li",null,JSX("a",{href:"#body"},"Body")),JSX("li",null,JSX("a",{href:"#options"},"Options")));d=f.renderDetails(d);var g=a.query;g=JSX("li",{class:"request-queryparams-panel"},JSX("div",{class:"uk-margin-top"},
JSX("label",{class:"uk-form-label",for:c+"-queryparams"},"Query Params"),JSX("textarea",{class:"uk-textarea",id:c+"-queryparams",name:"queryparams"},json.str(g))));var h=a.auth;h=JSX("li",{class:"request-auth-panel"},JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:c+"-auth"},"Auth"),JSX("textarea",{class:"uk-textarea",id:c+"-auth",name:"auth"},json.str(h))));var k=a.headers;k=JSX("li",{class:"request-headers-panel"},JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",
for:c+"-headers"},"Headers"),JSX("textarea",{class:"uk-textarea",id:c+"-headers",name:"headers"},json.str(k))));var l=a.body;l=JSX("li",{class:"request-body-panel"},JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:c+"-body"},"Body"),JSX("textarea",{class:"uk-textarea",id:c+"-body",name:"body"},json.str(l))));a=a.options;c=JSX("li",{class:"request-options-panel"},JSX("div",{class:"uk-margin-top"},JSX("label",{class:"uk-form-label",for:c+"-options"},"Options"),JSX("textarea",
{class:"uk-textarea",id:c+"-options",name:"options"},json.str(a))));return JSX("div",null,e,JSX("ul",{class:"uk-switcher uk-margin"},d,g,h,k,l,c))}})(b.form||(b.form={}))})(request||(request={}));
(function(b){(function(f){f.renderURL=function(d){var c="nav.navigate(`/c/"+collection.cache.active+"/"+d.key+"/call`);return false;";return JSX("div",{class:"uk-margin-top uk-panel"},JSX("div",{class:"left",style:"width:120px;"},JSX("select",{class:"uk-select",id:d.key+"-method",name:"method"},b.allMethods.map(function(a){return a.key===d.prototype.method?JSX("option",{selected:"selected"},a.key):JSX("option",null,a.key)}))),JSX("div",{class:"uk-inline right",style:"width:calc(100% - 120px);"},JSX("a",
{class:"uk-form-icon uk-form-icon-flip",href:"",onclick:c,title:"send request","uk-icon":"icon: play"}),JSX("form",{onsubmit:c},JSX("input",{class:"uk-input",id:d.key+"-url",name:"url",type:"text",value:b.prototypeToURL(d.prototype),"data-lpignore":"true"}))))}})(b.form||(b.form={}))})(request||(request={}));var system;
(function(b){var f=function(){function d(){}d.prototype.getProfile=function(){if(!this.profile)throw"no active profile";return this.profile};d.prototype.apply=function(c){b.cache.profile=c.profile};return d}();b.cache=new f})(system||(system={}));
(function(b){b.onSystemMessage=function(f,d){switch(f){case command.server.error:console.warn("error from server: "+d);break;case command.server.connected:b.cache.apply(d);break;default:console.warn("unhandled system command ["+f+"]")}}})(system||(system={}));var __spreadArrays=this&&this.__spreadArrays||function(){for(var b=0,f=0,d=arguments.length;f<d;f++)b+=arguments[f].length;b=Array(b);var c=0;for(f=0;f<d;f++)for(var a=arguments[f],e=0,g=a.length;e<g;e++,c++)b[c]=a[e];return b},ui;
(function(b){function f(a){for(var e=a.childElementCount-1;0<=e;e--){var g=a.children[e];g.classList.contains("dynamic")&&a.removeChild(g)}}function d(){return JSX("span",{class:"uk-navbar-item dynamic",style:"padding: 0 8px;"}," / ")}function c(a){for(var e=[],g=1;g<arguments.length;g++)e[g-1]=arguments[g];e=e.map(function(h){return"/"+h}).join("");return nav.link({path:e,title:a,cls:"uk-navbar-item uk-logo uk-margin-remove uk-padding-remove dynamic"})}b.setBreadcrumbs=function(a,e,g,h){var k=dom.req("#breadcrumbs");
f(k);k.appendChild(nav.link({path:"/",title:"npn",cls:"uk-navbar-item uk-logo uk-margin-remove uk-padding-remove dynamic"}));if(a&&(k.appendChild(d()),k.appendChild(c(a,"c",a)),e&&(k.appendChild(d()),k.appendChild(c(e,"c",a,e)),g&&(k.appendChild(d()),k.appendChild(c(g,"c",a,e,g)),h&&0<h.length))))for(var l=0;l<h.length;l++){k.appendChild(d());var m=[a,e,g];m.push.apply(m,h.slice(0,l));k.appendChild(c.apply(void 0,__spreadArrays([h[l]],m)))}};b.reset=f})(ui||(ui={}));
(function(b){b.setPanels=function(f,d,c,a){dom.setDisplay("#welcome-panel",void 0===f);dom.setDisplay("#collection-panel",void 0!==f&&0<f.length&&void 0===d);dom.setDisplay("#request-panel",void 0!==d&&0<d.length);b.setBreadcrumbs(f,d,c,a);a="";c&&(a+=c+" ");f&&(a+=f);d&&(a+="/"+d);a=0==a.length?"npn":"npn: "+a;document.title=a}})(ui||(ui={}));var dom;
(function(b){function f(g,h){var k=[];(h?h.querySelectorAll(g):document.querySelectorAll(g)).forEach(function(l){k.push(l)});return k}function d(g,h){h=f(g,h);switch(h.length){case 0:break;case 1:return h[0];default:console.warn("found ["+h.length+"] elements with selector ["+g+"], wanted zero or one")}}function c(g,h){(h=d(g,h))||console.warn("no element found for selector ["+g+"]");return h}function a(g,h){"string"===typeof g&&(g=c(g));g.innerHTML=h;return g}function e(g,h,k){void 0===k&&(k="block");
"string"===typeof g&&(g=c(g));g.style.display=h?k:"none";return g}b.initDom=function(g,h){try{style.themeLinks(h),style.setTheme(g)}catch(k){console.warn("error setting style",k)}try{modal.wire()}catch(k){console.warn("error wiring modals",k)}try{drop.wire()}catch(k){console.warn("error wiring drops",k)}try{tags.wire()}catch(k){console.warn("error wiring tag editors",k)}try{flash.wire()}catch(k){console.warn("error wiring tag editors",k)}};b.els=f;b.opt=d;b.req=c;b.setHTML=a;b.setDisplay=e;b.setContent=
function(g,h){"string"===typeof g&&(g=c(g));b.clear(g);Array.isArray(h)?h.forEach(function(k){return g.appendChild(k)}):g.appendChild(h);return g};b.setText=function(g,h){"string"===typeof g&&(g=c(g));g.innerText=h;return g};b.switchElements=function(g,h){e(g,!1);e(h,!0);return!1};b.clear=function(g){return a(g,"")}})(dom||(dom={}));
(function(b){b.setValue=function(f,d){"string"===typeof f&&(f=b.req(f));f.value=d;return f};b.wireTextarea=function(f){function d(){f.style.height="auto";f.style.height=(64>f.scrollHeight?64:f.scrollHeight+6)+"px"}function c(){window.setTimeout(d,0)}f.dataset.autoresize||(f.dataset.autoresize="true",f.addEventListener("change",d,!1),f.addEventListener("cut",c,!1),f.addEventListener("paste",c,!1),f.addEventListener("drop",c,!1),f.addEventListener("keydown",c,!1),f.focus(),f.select());d()};b.setOptions=
function(f,d){"string"===typeof f&&(f=b.req(f));b.clear(f);d.forEach(function(c){var a=document.createElement("option");a.value=c;b.setText(a,c);f.appendChild(a)})};b.setSelectOption=function(f,d){"string"===typeof f&&(f=b.req(f));for(var c=0;c<f.children.length;c++){var a=f.children.item(c);a.selected=a.value===d}};b.insertAtCaret=function(f,d){if(f.selectionStart||0===f.selectionStart){var c=f.selectionStart,a=f.selectionEnd;f.value=f.value.substring(0,c)+d+f.value.substring(a,f.value.length);f.selectionStart=
c+d.length;f.selectionEnd=c+d.length}else f.value+=d}})(dom||(dom={}));
function JSX(b,f){var d=document.createElement(b);for(a in f)if(a&&f.hasOwnProperty(a)){var c=f[a];"dangerouslySetInnerHTML"===a?dom.setHTML(d,c.__html):!0===c?d.setAttribute(a,a):!1!==c&&null!==c&&void 0!==c&&d.setAttribute(a,c.toString())}var a=function(g){var h=e[g];if(Array.isArray(h))h.forEach(function(k){if(void 0===h||null===h)throw"child array for tag ["+b+"] is "+h+"\n"+d.outerHTML;if(void 0===k||null===k)throw"child for tag ["+b+"] is "+k+"\n"+d.outerHTML;"string"===typeof k&&(k=document.createTextNode(k));
d.appendChild(k)});else{if(void 0===h||null===h)throw"child for tag ["+b+"] is "+h+"\n"+d.outerHTML;h.nodeType||(h=document.createTextNode(h.toString()));d.appendChild(h)}};var e=arguments;for(c=2;c<arguments.length;c++)a(c);return d}var style;
(function(b){function f(c){d(c);switch(c){case "auto":c="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(c="dark");f(c);fetch("/profile/theme/"+c).then(function(a){return a.text()}).then(function(){});break;case "light":document.documentElement.classList.remove("uk-light");document.body.classList.remove("uk-light");document.documentElement.classList.add("uk-dark");document.body.classList.add("uk-dark");break;case "dark":document.documentElement.classList.add("uk-light");
document.body.classList.add("uk-light");document.documentElement.classList.remove("uk-dark");document.body.classList.remove("uk-dark");break;default:console.warn("invalid theme")}}function d(c){if("undefined"===typeof EmojiButton)dom.els(".picker-toggle").forEach(function(e){return dom.setDisplay(e,!1)});else{var a={position:"bottom-end",theme:c,zIndex:1021};dom.els(".textarea-emoji").forEach(function(e){var g=dom.req(".picker-toggle",e);g.addEventListener("click",function(){var h=dom.req(".uk-textarea",
e),k=new EmojiButton(a);k.on("emoji",function(l){drop.onEmojiPicked();dom.insertAtCaret(h,l)});k.togglePicker(g)},!1)})}}b.setTheme=f;b.linkColor="";b.themeLinks=function(c){b.linkColor=c+"-fg";dom.els(".theme").forEach(function(a){a.classList.add(b.linkColor)})}})(style||(style={}));var drop;
(function(b){function f(e){if(e.target){var g=e.target;e=g.dataset.key||"";g=g.dataset.t||"";var h=events.getOpenEvent(e);h?h(g):console.warn("no drop open handler registered for ["+e+"]")}}function d(e){if(e.target){var g=e.target;g.classList.contains("uk-open")&&(e=g.dataset.t||"",(g=events.getCloseEvent(g.dataset.key||""))&&g(e))}}function c(e){a&&e.preventDefault()}b.wire=function(){dom.els(".drop").forEach(function(e){e.addEventListener("show",f);e.addEventListener("beforehide",c);e.addEventListener("hide",
d)})};var a=!1;b.onEmojiPicked=function(){a=!0;setTimeout(function(){return a=!1},200)}})(drop||(drop={}));var events;(function(b){var f,d;b.register=function(c,a,e){f||(f=new map.Map);d||(d=new map.Map);a||(a=function(){});f.set(c,a);e&&d.set(c,e)};b.getOpenEvent=function(c){return f.get(c)};b.getCloseEvent=function(c){return d.get(c)}})(events||(events={}));var flash;
(function(b){function f(){var c=!1;dom.els(".alert-top").forEach(function(a){c=!0;a.classList.add("uk-animation-fade","uk-animation-reverse")});c&&setTimeout(d,1E3)}function d(){dom.els(".alert-top").forEach(function(c){c.remove()})}b.wire=function(){setTimeout(f,4E3)}})(flash||(flash={}));var modal;
(function(b){function f(e,g){a=g;notify.modal("#modal-"+e).show();return!1}function d(e){if(e.target&&(e=e.target,0===e.id.indexOf("modal"))){e=e.id.substr(6);var g=events.getOpenEvent(e);g?g(a):console.warn("no modal open handler registered for ["+e+"]");a=void 0}}function c(e){e.target&&(e=e.target,e.classList.contains("uk-open")&&(e=e.id.substr(6),(e=events.getCloseEvent(e))&&e(a),a=void 0))}var a;b.wire=function(){dom.els(".modal").forEach(function(e){e.addEventListener("show",d);e.addEventListener("hide",
c)})};b.open=f;b.openSoon=function(e){setTimeout(function(){return f(e)},0)};b.hide=function(e){e=notify.modal("#modal-"+e);e.$el.classList.contains("uk-open")&&e.hide()}})(modal||(modal={}));var tags;
(function(b){function f(a){var e=dom.req(".value",a),g=dom.req(".editor",a);dom.setDisplay(e,!1);dom.setDisplay(g,!0);var h=b.renderInput(e.innerText);h.onblur=function(){e.innerText=h.value;dom.setDisplay(e,!0);dom.setDisplay(g,!1);c(a.parentElement)};h.onkeypress=function(k){return"Enter"===k.key?(h.blur(),!1):!0};dom.setContent(g,h);h.focus()}function d(a){a.target?c(a.target):console.warn("no event target")}function c(a){var e=a.dataset.key||"",g=events.getOpenEvent(e);g?g():console.warn("no tag open handler registered for ["+
e+"]");a=dom.els(".item",a).map(function(h){return h.innerText});dom.setValue("#model-"+e+"-input",a.join(","))}b.wire=function(){dom.els(".tag-editor").forEach(function(a){a.addEventListener("moved",d);a.addEventListener("added",d);a.addEventListener("removed",d)})};b.removeTag=function(a){a=a.parentElement;var e=a.parentElement;a.remove();c(e)};b.addTag=function(a){if(a=a.parentElement){var e=b.renderItem();a.insertBefore(e,dom.req(".add-item",a));f(e)}};b.editTag=f})(tags||(tags={}));
(function(b){b.renderInput=function(f){return JSX("input",{type:"text",class:"uk-input",value:f})};b.renderItem=function(){return JSX("span",{class:"item"},JSX("span",{class:"value",onclick:"tags.editTag(this.parentElement);"}),JSX("span",{class:"editor"}),JSX("span",{class:"close","data-uk-icon":"icon: close; ratio: 0.6;",onclick:"tags.removeTag(this);"}))};b.renderTagsView=function(f){return JSX("div",{class:"tag-view"},f.map(function(d){return JSX("span",{class:"item"},d)}),JSX("div",{class:"clear"}))}})(tags||
(tags={}));var socket;(function(b){b.initBypass=function(){b.bypass=!0;b.connected=!0;nav.enabled=!1};b.bypassSend=function(f){b.debug&&console.debug("out",f);npn_handler?npn_handler(JSON.stringify(f,null,2)):console.warn("no bypass handler configured")}})(socket||(socket={}));
(function(b){b.debug=!0;b.appUnloading=!1;b.currentService="";b.currentID="";b.bypass=!1;b.setAppUnloading=function(){b.appUnloading=!0};b.send=function(f){b.bypass?b.bypassSend(f):b.socketSend(f)};b.recv=function(f){b.debug&&console.debug("in",f);switch(f.svc){case services.system.key:system.onSystemMessage(f.cmd,f.param);break;case services.collection.key:collection.onCollectionMessage(f.cmd,f.param);break;case services.request.key:request.onRequestMessage(f.cmd,f.param);break;default:console.warn("unhandled message for service ["+
f.svc+"]")}}})(socket||(socket={}));
(function(b){function f(){var l=document.location,m="ws";"https:"===l.protocol&&(m="wss");return m+("://"+l.host+"/s")}function d(){g=new WebSocket(f());g.onopen=a;g.onmessage=function(l){return b.recv(json.parse(l.data))};g.onerror=function(l){return npn.onError("socket",l.type)};g.onclose=e}function c(l,m,n){b.currentService=l;b.currentID=m;b.connectTime=Date.now();n?b.initBypass():d()}function a(){log.info("socket connected");b.connected=!0;h=1;k.forEach(b.send);k=[]}function e(){function l(){b.connected=
!1;var m=Date.now()-b.connectTime;2E3>m?(h*=2,b.debug&&console.debug("socket closed immediately, reconnecting in "+h+" seconds"),setTimeout(function(){c(b.currentService,b.currentID)},1E3*h)):(log.info("socket closed after ["+m+"ms]"),c(b.currentService,b.currentID))}b.appUnloading||l()}var g;b.connected=!1;var h=0,k=[];b.initSocket=d;b.socketConnect=c;b.socketSend=function(l){b.debug&&console.debug("out",l);b.connected?(l=json.str(l),g.send(l)):k.push(l)}})(socket||(socket={}));var profile;
(function(b){b.setNavColor=function(f,d){dom.setValue("#nav-color",d);dom.req("#navbar").className=d+"-bg uk-navbar-container uk-navbar";document.querySelectorAll(".nav_swatch").forEach(function(c){c.classList.remove("active")});f.classList.add("active")};b.setLinkColor=function(f,d){dom.setValue("#link-color",d);dom.els(".profile-link").forEach(function(c){c.classList.forEach(function(a){-1<a.indexOf("-fg")&&c.classList.remove(a);c.classList.add(d+"-fg")})});document.querySelectorAll(".link_swatch").forEach(function(c){c.classList.remove("active")});
f.classList.add("active")};b.setPicture=function(f){dom.setValue("#self-picture-input",f);return!1}})(profile||(profile={}));var arr;(function(b){b.find=function(f,d){for(var c=f.length>>>0,a=0;a<c;){var e=f[a];if(d(a,e))return e;a++}}})(arr||(arr={}));var date;
(function(b){function f(a){return a.toLocaleDateString()}function d(a){return a.toLocaleTimeString().slice(0,8)}b.dateToYMD=function(a){var e=a.getDate(),g=a.getMonth()+1;return a.getFullYear()+"-"+(9>=g?"0"+g:g)+"-"+(9>=e?"0"+e:e)};b.dateFromYMD=function(a){a=new Date(a);return new Date(a.getTime()+6E4*a.getTimezoneOffset())};b.dow=function(a){switch(a){case 0:return"Sun";case 1:return"Mon";case 2:return"Tue";case 3:return"Wed";case 4:return"Thu";case 5:return"Fri";case 6:return"Sat";default:return"???"}};
b.toDateString=f;b.toTimeString=d;b.toDateTimeString=function(a){return f(a)+" "+d(a)};var c=6E4*(new Date).getTimezoneOffset();b.utcDate=function(a){return new Date(Date.parse(a)+c)}})(date||(date={}));var group;
(function(b){function f(e,g){if(!e)return[];e.sort(function(h,k){h=g(h);k=g(k);return h>k?1:h<k?-1:0});return e}function d(e,g,h){if(!e)return[g];var k=!1,l=h(g),m;for(m in e)h(e[m])==l&&(k=!0,e[m]=g);k||e.push(g);return e}var c=function(){return function(e){this.members=[];this.key=e}}();b.Group=c;var a=function(){function e(){this.groups=[]}e.prototype.findOrInsert=function(g){var h=arr.find(this.groups,function(k,l){return l.key===g});if(h)return h;h=new c(g);this.groups.push(h);return h};return e}();
b.GroupSet=a;b.groupBy=function(e,g){var h=new a;e&&e.forEach(function(k){h.findOrInsert(g(k)).members.push(k)});return h};b.findGroup=function(e,g){for(var h=0;h<e.length;h++){var k=e[h];if(k.key===g)return k.members}return[]};b.flatten=function(e){var g=[];e.forEach(function(h){return g.push.apply(g,h)});return g};b.sort=f;b.update=d;b.updateAndSort=function(e,g,h){return f(d(e,g,h),h)}})(group||(group={}));var json;
(function(b){b.str=function(f){return void 0===f?"null":JSON.stringify(f,null,2)};b.parse=function(f){return JSON.parse(f)}})(json||(json={}));var log;
(function(b){function f(g,h){if(0===c)console.warn("call `log.init()` before attempting to log");else{var k=Date.now()-c;k=JSX("li",{class:d(g)},JSX("div",{class:"right"},k,"ms"),h);if(!e&&(e=dom.opt("#log-list"),!e)){console.warn(g+": "+h);return}e.appendChild(k);a||(a=dom.req("#log-content"));a.scrollTo(0,a.scrollHeight)}}function d(g){switch(g){case "debug":return"grey-fg";case "info":return"";case "warn":return"yellow-fg";case "error":return"red-fg";default:return""}}var c=0,a,e;b.init=function(){c=
Date.now();f("debug","npn started")};b.info=function(g){f("info",g)};b.l=f;b.toggle=function(){var g=dom.req("#workspace-content"),h=dom.req("#log-container"),k=""!==h.style.display&&"none"!==h.style.display;k?g.classList.remove("log-visible"):g.classList.add("log-visible");dom.setDisplay(h,!k);a||(a=dom.req("#log-content"));a.scrollTo(0,a.scrollHeight)}})(log||(log={}));var map;
(function(b){var f=function(){function d(){this.storage=Object.create(null)}d.prototype.get=function(c){return this.storage[c]};d.prototype.set=function(c,a){return this.storage[c]=a};return d}();b.Map=f})(map||(map={}));var nav;
(function(b){function f(c){if(!b.enabled)return d(c),"";if(str.startsWith(c,"text/html;"))return"";str.startsWith(c,"/")&&(c=c.substr(1));var a=location.pathname;str.startsWith(a,"/")&&(a=a.substr(1));a!==c&&(a=c,history.pushState(a,"","/"+a));d(c)}b.enabled=!0;var d=function(c){console.warn("default nav handler called: "+c)};b.init=function(c){d=c;window.onpopstate=function(a){a.state?d(a.state):d("")};f(location.pathname)};b.pop=function(){var c=location.pathname.substr(0,location.pathname.lastIndexOf("/"));
"/c"===c&&(c="");f(c)};b.navigate=f;b.navActiveRequest=function(){f("/c/"+collection.cache.active+"/"+request.cache.active)};b.link=function(c){var a=c.path;str.startsWith(a,"/")||(a="/"+a);c.cls=c.cls?" "+c.cls.trim():"";var e=JSX("span",null);c.icon&&(e=JSX("span",{class:"nav-icon","data-uk-icon":"icon: "+c.icon}));c.onclk?str.endsWith(c.onclk,";")||(c.onclk+=";"):c.onclk="";c.isButton||(c.cls=style.linkColor+c.cls);return JSX("a",{class:c.cls,href:a,onclick:c.onclk+"nav.navigate('"+c.path+"', '"+
c.title+"');return false;"},e,c.title)}})(nav||(nav={}));var notify;(function(b){b.notify=function(f,d){UIkit.notification(f,{status:d?"success":"danger",pos:"top-right"})};b.confirm=function(f,d){UIkit.modal.confirm(f).then(d)};b.modal=function(f){var d=UIkit.modal(f);d||console.warn("no modal available with key ["+f+"]");return d}})(notify||(notify={}));var str;
(function(b){function f(c,a,e){e=e&&0<e?e|0:0;return c.substring(e,e+a.length)===a}function d(c,a,e){e=e&&e<c.length?e:c.length;return c.substring(e-a.length,e)===a}b.startsWith=f;b.endsWith=d;b.trimPrefix=function(c,a){return f(c,a)?c.slice(a.length):c};b.trimSuffix=function(c,a){return d(c,a)?c.substring(0,c.lastIndexOf(a)):c}})(str||(str={}));
